{"ast":null,"code":"var _jsxFileName = \"/Users/wengyifan/Desktop/dsdn/dsdn/src/components/Modal/Modal.jsx\",\n    _s = $RefreshSig$();\n\nimport { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { loadContract, mintNFT } from \"../../contracts/interact\";\nimport { pinJSONToIPFS } from \"../../contracts/pinata\";\nimport { addPost } from \"../../features/posts/postsSlice\";\nimport { imageUpload } from \"../../service/imageUpload\";\nimport { addBlog, updateBlog } from \"../../service/postService\";\nimport Button from \"@mui/material/Button\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogContentText from \"@mui/material/DialogContentText\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport \"./modal.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport function ModalContainer(_ref) {\n  _s();\n\n  let {\n    setOpen,\n    data,\n    setData\n  } = _ref;\n  const {\n    uId,\n    accountId: Address\n  } = useSelector(state => state.user);\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [imageUrl, setImageUrl] = useState(null);\n  const dispatch = useDispatch();\n  const [localData, setLocalData] = useState(data);\n  const {\n    text\n  } = localData; // dialog logic\n\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const handleUpload = _ref2 => {\n    let {\n      target\n    } = _ref2;\n    console.log(target.files[0]);\n    const image = target.files[0];\n    setSelectedImage(URL.createObjectURL(image));\n    imageUpload(image).then(url => {\n      console.log(url);\n      setImageUrl(url);\n    }); // uploadImage(image);\n  };\n\n  function close() {\n    setOpen(false);\n  }\n\n  const sendToServer = async post => {\n    const res = await addBlog(post);\n    return res;\n  };\n\n  const sendToIPFS = async fileLink => {\n    const pinataResponse = await pinJSONToIPFS(fileLink);\n\n    if (!pinataResponse.success) {\n      return {\n        success: false,\n        status: \"ðŸ˜¢ Something went wrong while uploading your tokenURI.\"\n      };\n    }\n\n    console.log(pinataResponse);\n    const tokenURI = pinataResponse.pinataUrl;\n    return tokenURI;\n  };\n\n  function submit() {\n    setData({\n      text: \"\"\n    });\n    setDialogOpen(true);\n  } // add post to server only\n\n\n  const submitContent = async () => {\n    const post = {\n      Address,\n      blogText: text,\n      imageUrl,\n      uId\n    };\n    const postLink = await sendToServer(post);\n    dispatch(addPost(postLink));\n    close();\n  }; // nft mint and add to server\n\n\n  const submitNFT = async () => {\n    const post = {\n      Address,\n      blogText: text,\n      imageUrl,\n      uId\n    };\n    const res = await sendToServer(post);\n    const id = res[0].id;\n    const tokenURI = await sendToIPFS(res[0]);\n    await updateBlog(id, tokenURI);\n    const contract = await loadContract();\n    await mintNFT(tokenURI, contract, Address);\n    dispatch(addPost({ ...post,\n      ipfsUrl: tokenURI\n    }));\n    close();\n  };\n\n  return /*#__PURE__*/ReactDOM.createPortal( /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(DialogNFT, {\n      open: dialogOpen,\n      setOpen: setDialogOpen,\n      handleContent: submitContent,\n      handleNFT: submitNFT\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modalShadow\",\n      onClick: close\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalBanner\",\n        children: \"Post Your New Clip\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalClose\",\n        onClick: close,\n        children: /*#__PURE__*/_jsxDEV(\"svg\", {\n          t: \"1640244753525\",\n          viewBox: \"0 0 1024 1024\",\n          version: \"1.1\",\n          xmlns: \"http://www.w3.org/2000/svg\",\n          \"p-id\": \"3003\",\n          width: \"32\",\n          height: \"32\",\n          children: /*#__PURE__*/_jsxDEV(\"path\", {\n            d: \"M844.330667 179.669333a30.72 30.72 0 0 1 0 43.456l-288.853334 288.853334 288.853334 288.896a30.72 30.72 0 1 1-43.456 43.456l-288.853334-288.896-288.896 288.896a30.72 30.72 0 1 1-43.456-43.456L468.565333 512 179.669333 223.146667a30.72 30.72 0 0 1 43.456-43.456L512 468.522667l288.853333-288.853334a30.72 30.72 0 0 1 43.456 0z\",\n            fill: \"#52C3E6\",\n            \"p-id\": \"3004\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalContent\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          name: \"modalText\",\n          id: \"modalText\",\n          cols: \"30\",\n          rows: \"10\",\n          placeholder: \"Write here...\",\n          value: localData.text,\n          onChange: _ref3 => {\n            let {\n              target\n            } = _ref3;\n            setLocalData({ ...localData,\n              text: target.value\n            });\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 11\n        }, this), selectedImage && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modalImage\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: selectedImage,\n            alt: \"selectedImage\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setSelectedImage(null),\n            children: \"Remove\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"modalFooter\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"add-media\",\n          className: \"modalAddMedia\",\n          onClick: () => {},\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            t: \"1640245222739\",\n            viewBox: \"0 0 1024 1024\",\n            version: \"1.1\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            \"p-id\": \"3139\",\n            width: \"200\",\n            height: \"200\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M815.020408 167.183673a114.938776 114.938776 0 0 1 114.938776 114.938776v438.857143a114.938776 114.938776 0 0 1-114.938776 114.938775h-606.040816A114.938776 114.938776 0 0 1 94.040816 720.979592v-438.857143A114.938776 114.938776 0 0 1 208.979592 167.183673z m-459.755102 472.732735L221.936327 773.22449h266.637061L355.265306 639.916408z m290.230857-63.007347l-140.07902 124.510041 60.10253 60.081633c3.406367 3.427265 5.872327 7.439673 7.397878 11.723755H815.020408c2.821224 0 5.600653-0.20898 8.317388-0.668735l-177.841633-195.646694zM815.020408 229.877551h-606.040816A52.244898 52.244898 0 0 0 156.734694 282.122449v438.857143c0 8.380082 1.964408 16.300408 5.475265 23.322122l170.882612-170.882612a31.346939 31.346939 0 0 1 41.963102-2.15249l2.382368 2.15249 83.570939 83.591837 165.992489-147.539592a31.346939 31.346939 0 0 1 39.350858-1.880816l2.424163 1.985306 2.256979 2.236081 195.855674 215.45796c0.250776-2.068898 0.376163-4.179592 0.376163-6.290286v-438.857143a52.244898 52.244898 0 0 0-52.244898-52.244898zM344.816327 292.571429a104.489796 104.489796 0 1 1 0 208.979591 104.489796 104.489796 0 0 1 0-208.979591z m0 62.693877a41.795918 41.795918 0 1 0 0 83.591837 41.795918 41.795918 0 0 0 0-83.591837z\",\n              fill: \"white\",\n              \"p-id\": \"3140\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 174,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"file\",\n            name: \"add-media\",\n            id: \"add-media\",\n            accept: \"image/*\",\n            style: {\n              display: \"none\"\n            },\n            onChange: handleUpload\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 180,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 160,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"modalBottomButton\",\n          onClick: submit,\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true), document.getElementById(\"app-modal\"));\n}\n\n_s(ModalContainer, \"r3r5oqQEkFSiwImFDbFs1qbWyEo=\", false, function () {\n  return [useSelector, useDispatch];\n});\n\n_c = ModalContainer;\n\nconst DialogNFT = _ref4 => {\n  let {\n    open,\n    setOpen,\n    handleContent,\n    handleNFT\n  } = _ref4;\n\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(Dialog, {\n    className: \"dialogNFT\",\n    open: open,\n    onClose: handleClose,\n    \"aria-labelledby\": \"dialog-title\",\n    \"aria-describedby\": \"dialog-description\",\n    children: [/*#__PURE__*/_jsxDEV(DialogTitle, {\n      id: \"alert-dialog-title\",\n      children: \"Make this content NFT?\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogContent, {\n      children: /*#__PURE__*/_jsxDEV(DialogContentText, {\n        id: \"alert-dialog-description\",\n        children: \"Confirm to make this content NFT, you will not be able to edit it. If you want to edit it, you need to make it a normal content.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DialogActions, {\n      className: \"dialogNFTButtons\",\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        onClick: handleContent,\n        style: {\n          color: \"#52c3e6\",\n          border: \"1px solid #52c3e6\"\n        },\n        children: \"Normal Content\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"outlined\",\n        onClick: handleNFT,\n        style: {\n          color: \"#52c3e6\",\n          border: \"1px solid #52c3e6\"\n        },\n        autoFocus: true,\n        children: \"NFT\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 205,\n    columnNumber: 5\n  }, this);\n};\n\n_c2 = DialogNFT;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"ModalContainer\");\n$RefreshReg$(_c2, \"DialogNFT\");","map":{"version":3,"sources":["/Users/wengyifan/Desktop/dsdn/dsdn/src/components/Modal/Modal.jsx"],"names":["useState","ReactDOM","useDispatch","useSelector","loadContract","mintNFT","pinJSONToIPFS","addPost","imageUpload","addBlog","updateBlog","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","ModalContainer","setOpen","data","setData","uId","accountId","Address","state","user","selectedImage","setSelectedImage","imageUrl","setImageUrl","dispatch","localData","setLocalData","text","dialogOpen","setDialogOpen","handleUpload","target","console","log","files","image","URL","createObjectURL","then","url","close","sendToServer","post","res","sendToIPFS","fileLink","pinataResponse","success","status","tokenURI","pinataUrl","submit","submitContent","blogText","postLink","submitNFT","id","contract","ipfsUrl","createPortal","value","display","document","getElementById","DialogNFT","open","handleContent","handleNFT","handleClose","color","border"],"mappings":"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","sourcesContent":["import { useState } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { loadContract, mintNFT } from \"../../contracts/interact\";\nimport { pinJSONToIPFS } from \"../../contracts/pinata\";\nimport { addPost } from \"../../features/posts/postsSlice\";\nimport { imageUpload } from \"../../service/imageUpload\";\nimport { addBlog, updateBlog } from \"../../service/postService\";\nimport Button from \"@mui/material/Button\";\nimport Dialog from \"@mui/material/Dialog\";\nimport DialogActions from \"@mui/material/DialogActions\";\nimport DialogContent from \"@mui/material/DialogContent\";\nimport DialogContentText from \"@mui/material/DialogContentText\";\nimport DialogTitle from \"@mui/material/DialogTitle\";\nimport \"./modal.css\";\n\nexport function ModalContainer({ setOpen, data, setData }) {\n  const { uId, accountId: Address } = useSelector((state) => state.user);\n\n  const [selectedImage, setSelectedImage] = useState(null);\n  const [imageUrl, setImageUrl] = useState(null);\n\n  const dispatch = useDispatch();\n\n  const [localData, setLocalData] = useState(data);\n  const { text } = localData;\n\n  // dialog logic\n  const [dialogOpen, setDialogOpen] = useState(false);\n\n  const handleUpload = ({ target }) => {\n    console.log(target.files[0]);\n    const image = target.files[0];\n    setSelectedImage(URL.createObjectURL(image));\n\n    imageUpload(image).then((url) => {\n      console.log(url);\n      setImageUrl(url);\n    });\n    // uploadImage(image);\n  };\n\n  function close() {\n    setOpen(false);\n  }\n\n  const sendToServer = async (post) => {\n    const res = await addBlog(post);\n    return res;\n  };\n\n  const sendToIPFS = async (fileLink) => {\n    const pinataResponse = await pinJSONToIPFS(fileLink);\n    if (!pinataResponse.success) {\n      return {\n        success: false,\n        status: \"ðŸ˜¢ Something went wrong while uploading your tokenURI.\",\n      };\n    }\n    console.log(pinataResponse);\n    const tokenURI = pinataResponse.pinataUrl;\n    return tokenURI;\n  };\n\n  function submit() {\n    setData({\n      text: \"\",\n    });\n\n    setDialogOpen(true);\n  }\n\n  // add post to server only\n  const submitContent = async () => {\n    const post = {\n      Address,\n      blogText: text,\n      imageUrl,\n      uId,\n    };\n    const postLink = await sendToServer(post);\n    dispatch(addPost(postLink));\n    close();\n  };\n\n  // nft mint and add to server\n  const submitNFT = async () => {\n    const post = {\n      Address,\n      blogText: text,\n      imageUrl,\n      uId,\n    };\n\n    const res = await sendToServer(post);\n    const id = res[0].id;\n    const tokenURI = await sendToIPFS(res[0]);\n    await updateBlog(id, tokenURI);\n    const contract = await loadContract();\n\n    await mintNFT(tokenURI, contract, Address);\n\n    dispatch(addPost({ ...post, ipfsUrl: tokenURI }));\n    close();\n  };\n\n  return ReactDOM.createPortal(\n    <>\n      <DialogNFT\n        open={dialogOpen}\n        setOpen={setDialogOpen}\n        handleContent={submitContent}\n        handleNFT={submitNFT}\n      />\n      <div className=\"modalShadow\" onClick={close} />\n      <div className=\"modal\">\n        <div className=\"modalBanner\">Post Your New Clip</div>\n        <div className=\"modalClose\" onClick={close}>\n          <svg\n            t=\"1640244753525\"\n            viewBox=\"0 0 1024 1024\"\n            version=\"1.1\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            p-id=\"3003\"\n            width=\"32\"\n            height=\"32\"\n          >\n            <path\n              d=\"M844.330667 179.669333a30.72 30.72 0 0 1 0 43.456l-288.853334 288.853334 288.853334 288.896a30.72 30.72 0 1 1-43.456 43.456l-288.853334-288.896-288.896 288.896a30.72 30.72 0 1 1-43.456-43.456L468.565333 512 179.669333 223.146667a30.72 30.72 0 0 1 43.456-43.456L512 468.522667l288.853333-288.853334a30.72 30.72 0 0 1 43.456 0z\"\n              fill=\"#52C3E6\"\n              p-id=\"3004\"\n            ></path>\n          </svg>\n        </div>\n        <div className=\"modalContent\">\n          <textarea\n            name=\"modalText\"\n            id=\"modalText\"\n            cols=\"30\"\n            rows=\"10\"\n            placeholder=\"Write here...\"\n            value={localData.text}\n            onChange={({ target }) => {\n              setLocalData({\n                ...localData,\n                text: target.value,\n              });\n            }}\n          />\n\n          {selectedImage && (\n            <div className=\"modalImage\">\n              <img src={selectedImage} alt=\"selectedImage\" />\n              <button onClick={() => setSelectedImage(null)}>Remove</button>\n            </div>\n          )}\n        </div>\n\n        <div className=\"modalFooter\">\n          <label\n            htmlFor=\"add-media\"\n            className=\"modalAddMedia\"\n            onClick={() => {}}\n          >\n            <svg\n              t=\"1640245222739\"\n              viewBox=\"0 0 1024 1024\"\n              version=\"1.1\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              p-id=\"3139\"\n              width=\"200\"\n              height=\"200\"\n            >\n              <path\n                d=\"M815.020408 167.183673a114.938776 114.938776 0 0 1 114.938776 114.938776v438.857143a114.938776 114.938776 0 0 1-114.938776 114.938775h-606.040816A114.938776 114.938776 0 0 1 94.040816 720.979592v-438.857143A114.938776 114.938776 0 0 1 208.979592 167.183673z m-459.755102 472.732735L221.936327 773.22449h266.637061L355.265306 639.916408z m290.230857-63.007347l-140.07902 124.510041 60.10253 60.081633c3.406367 3.427265 5.872327 7.439673 7.397878 11.723755H815.020408c2.821224 0 5.600653-0.20898 8.317388-0.668735l-177.841633-195.646694zM815.020408 229.877551h-606.040816A52.244898 52.244898 0 0 0 156.734694 282.122449v438.857143c0 8.380082 1.964408 16.300408 5.475265 23.322122l170.882612-170.882612a31.346939 31.346939 0 0 1 41.963102-2.15249l2.382368 2.15249 83.570939 83.591837 165.992489-147.539592a31.346939 31.346939 0 0 1 39.350858-1.880816l2.424163 1.985306 2.256979 2.236081 195.855674 215.45796c0.250776-2.068898 0.376163-4.179592 0.376163-6.290286v-438.857143a52.244898 52.244898 0 0 0-52.244898-52.244898zM344.816327 292.571429a104.489796 104.489796 0 1 1 0 208.979591 104.489796 104.489796 0 0 1 0-208.979591z m0 62.693877a41.795918 41.795918 0 1 0 0 83.591837 41.795918 41.795918 0 0 0 0-83.591837z\"\n                fill=\"white\"\n                p-id=\"3140\"\n              ></path>\n            </svg>\n            <input\n              type=\"file\"\n              name=\"add-media\"\n              id=\"add-media\"\n              accept=\"image/*\"\n              style={{ display: \"none\" }}\n              onChange={handleUpload}\n            />\n          </label>\n          <button className=\"modalBottomButton\" onClick={submit}>\n            Submit\n          </button>\n        </div>\n      </div>\n    </>,\n    document.getElementById(\"app-modal\")\n  );\n}\n\nconst DialogNFT = ({ open, setOpen, handleContent, handleNFT }) => {\n  const handleClose = () => {\n    setOpen(false);\n  };\n\n  return (\n    <Dialog\n      className=\"dialogNFT\"\n      open={open}\n      onClose={handleClose}\n      aria-labelledby=\"dialog-title\"\n      aria-describedby=\"dialog-description\"\n    >\n      <DialogTitle id=\"alert-dialog-title\">\n        {\"Make this content NFT?\"}\n      </DialogTitle>\n      <DialogContent>\n        <DialogContentText id=\"alert-dialog-description\">\n          Confirm to make this content NFT, you will not be able to edit it. If\n          you want to edit it, you need to make it a normal content.\n        </DialogContentText>\n      </DialogContent>\n      <DialogActions className=\"dialogNFTButtons\">\n        <Button\n          variant=\"outlined\"\n          onClick={handleContent}\n          style={{ color: \"#52c3e6\", border: \"1px solid #52c3e6\" }}\n        >\n          Normal Content\n        </Button>\n        <Button\n          variant=\"outlined\"\n          onClick={handleNFT}\n          style={{ color: \"#52c3e6\", border: \"1px solid #52c3e6\" }}\n          autoFocus\n        >\n          NFT\n        </Button>\n      </DialogActions>\n    </Dialog>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}